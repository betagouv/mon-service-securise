- const estSurCreationDeService = !!service.id === false

mixin etapeParcours({ id, position, url, description, sousTitre, statut, rubriqueDroit })
  -
    const estActive = etapeActive === id
    const estVisible = estSurCreationDeService || !(autorisationsService[rubriqueDroit].estMasque)
    const statutSaisie = (s) => {
      switch (s) {
        case InformationsHomologation.COMPLETES: return 'faite';
        case InformationsHomologation.A_COMPLETER: return 'en-cours';
        default: return '';
      }
    }

  if estVisible
    li
      a(href = estSurCreationDeService ? '#' : url, class = estActive ? 'actif' : '')
        .pastille
          span.action-saisie(id = id)
        .none-si-ferme
          span.nom-action!= description
          span.sous-titre!= sousTitre
        .statut-saisie.none-si-ferme(class = statutSaisie(statut))


.menu-navigation(class = preferencesUtilisateur.etatMenuNavigation === 'ferme' ? 'ferme' : '')
  .actions
    if !estSurCreationDeService
      button#gerer-contributeurs
        img(src = '/statique/assets/images/bouton_inviter_collaborateur_persona.svg')
        span.none-si-ferme.nombre-contributeurs= service.contributeurs.length
        span.inviter-contributeurs Gérer les contributeurs
    button.repli-menu
      img(src = '/statique/assets/images/forme_chevron_blanc.svg' alt='Chevron vers la gauche')

  .parcours
    ul.etapes
      each actionSaisie in actionsSaisie
        +etapeParcours(actionSaisie)

  if !estSurCreationDeService
    .autres-liens
      ul
        if !autorisationsService.RISQUES.estMasque
          li
            a(href = `/service/${service.id}/risques`, class = etapeActive === 'risques' ? 'actif' : '')
              .pastille
                img(src = '/statique/assets/images/icone_risques.svg' alt="Icône d'un panneau « Danger »", id = 'icone-risques')
              span.none-si-ferme Risques
        if !autorisationsService.CONTACTS.estMasque
          li
            a(href = `/service/${service.id}/rolesResponsabilites`, class = etapeActive === 'contactsUtiles' ? 'actif' : '')
              .pastille
                img(src = '/statique/assets/images/icone_contacts_utiles.svg' alt="Icône d'un livre ouvert")
              span.none-si-ferme Contacts utiles
        li
          a#voir-telechargement(href = '#')
            .pastille
              img(src = '/statique/assets/images/icone_telechargement_fichier.svg' alt='Icône de téléchargement de fichier')
            span.none-si-ferme Télécharger les PDF

