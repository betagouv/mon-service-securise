include ../carteInformations

block append styles
  link(href = '/statique/assets/styles/cartes/indiceCyber.css', rel = 'stylesheet')

mixin indiceCyber({ referentiel, indiceCyber })
  - const indiceCyberMax = referentiel.indiceCyberMax()
  - const formatte = Intl.NumberFormat('fr', { minimumFractionDigits: 1, maximumFractionDigits: 1 }).format

  mixin detailsIndiceCyber
    h3 Par catégorie de mesure
    dl
      each id in referentiel.identifiantsCategoriesMesures()
        dt= referentiel.descriptionCategorie(id)
        dd= (typeof indiceCyber[id] === 'number' ? `${formatte(indiceCyber[id])} / ${indiceCyberMax}` : '–')

    h3 Qu'est-ce que l'indice cyber ?
    p.
      L'indice cyber est calculé à partir des mesures de sécurité renseignées
      et mises en œuvre par l'équipe par rapport à l'ensemble des mesures
      proposées par l'ANSSI. Il fournit une évaluation indicative du niveau de
      sécurité du service.

    p: a(href = '/questionsFrequentes#indice-cyber', target = '_blank', rel = 'noopener').nouvel-onglet En savoir plus


  - const { total } = indiceCyber
  +carteInformations({ titre: 'Indice cyber', sousTitre: "Évalué par l'ANSSI", details: 'detailsIndiceCyber' })
    .score-indice-cyber
      .logo
        div(class = `disque couleur-indice-cyber-${Math.floor(total)}`)
        div(class = `curseur position-${Math.floor(total)}`)
        span.score= formatte(total)
        span.score-max= `/${indiceCyberMax}`
