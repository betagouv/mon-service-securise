include ../carteInformations

block append styles
  link(href = '/statique/assets/styles/cartes/indiceCyber.css', rel = 'stylesheet')

mixin indiceCyber({ referentiel, indiceCyber })
  - const indiceCyberMax = referentiel.indiceCyberMax()
  - const formatte = Intl.NumberFormat('fr', { minimumFractionDigits: 1, maximumFractionDigits: 1 }).format

  mixin detailsIndiceCyber
    h3 Par catégorie de mesure
    dl
      each id in referentiel.identifiantsCategoriesMesures()
        dt= referentiel.descriptionCategorie(id)
        dd= (typeof indiceCyber[id] === 'number' ? `${formatte(indiceCyber[id])} / ${indiceCyberMax}` : '–')

    h3 À quoi sert l'indice cyber ?
    p.
      L'indice cyber fournit une indication du niveau de sécurité du
      service basée sur une évaluation de la conformité de ce dernier à un
      socle de mesures de sécurité personnalisé.
    p.
      Cette note ne constitue pas une preuve effective de la sécurité du
      service. MonServiceSécurisé et l'ANSSI ne peuvent en aucun cas être tenus
      responsables d'incidents de sécurité susceptibles d'affecter le service
      numérique, quelle que soit la note attribuée à ce dernier.

    p: a(href = '/questionsFrequentes#indice-cyber', target = '_blank', rel = 'noopener').nouvel-onglet En savoir plus


  - const { total } = indiceCyber
  +carteInformations({ titre: 'Indice cyber', sousTitre: "Évalué par l'ANSSI", details: 'detailsIndiceCyber' })
    .score-indice-cyber
      .logo
        div(class = `disque couleur-indice-cyber-${Math.floor(total)}`)
        div(class = `curseur position-${Math.floor(total)}`)
        span.score= formatte(total)
        span.score-max= `/${indiceCyberMax}`
