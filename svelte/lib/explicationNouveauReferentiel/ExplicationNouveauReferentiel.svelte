<script lang="ts">
  import Modale from '../ui/Modale.svelte';
  import { onMount } from 'svelte';
  let elementModale: Modale;

  onMount(() => {
    elementModale?.affiche();
  });

  const termineExplications = async () => {
    await axios.post('/api/explicationNouveauReferentiel/termine');
    elementModale?.ferme();
  };
</script>

<Modale bind:this={elementModale} id="modale-explication-nouveau-referentiel">
  <svelte:fragment slot="contenu">
    <dsfr-badge
      label="Nouveau"
      type="accent"
      accent="yellow-tournesol"
      size="md"
      hasIcon
      icon="flashlight-fill"
    />
    <h4>Mise en place d‚Äôun nouveau r√©f√©rentiel de mesures</h4>
    <div class="contenu-modale">
      <p>
        <b
          >Le formulaire d‚Äôajout de service a √©t√© mis √† jour avec de nouvelles
          questions. Les mesures associ√©es √† chaque besoin de s√©curit√© ont
          √©galement √©t√© √©volu√©es : certaines ont √©t√© ajout√©es, d'autres
          modifi√©es ou supprim√©es.</b
        >
      </p>
      <div>
        <p><b>Les principaux axes de cette mise √† jour :</b></p>
        <ul>
          <li>Des mesures s√©par√©es pour une analyse plus fine</li>
          <li>
            Des ajouts de mesures "simples" bas√©es sur les bonnes pratiques
          </li>
          <li>Un alignement avec la directive NIS2</li>
          <li>
            Une meilleure adaptation au p√©rim√®tre d‚Äôhomologation, selon les
            contextes
          </li>
          <li>
            Un renforcement du principe de proportionnalit√©, pour cibler les
            mesures l√† o√π les risques sont les plus √©lev√©s.
          </li>
        </ul>
      </div>
      <div>
        <h5>√âvolution du nombre de mesures</h5>
        <p>
          Le nombre affich√© pour chaque besoin de s√©curit√© est le maximum
          possible (par exemple si votre service pr√©sente un grand nombre de
          caract√©ristiques)
        </p>
      </div>
    </div>
  </svelte:fragment>
  <svelte:fragment slot="actions">
    <lab-anssi-bouton
      titre="J‚Äôai compris üëç"
      variante="primaire"
      taille="md"
      icone=""
      positionIcone="sans"
      on:click={termineExplications}
    />
  </svelte:fragment>
</Modale>

<style lang="scss">
  :global(#modale-explication-nouveau-referentiel) {
    max-width: 792px;
    max-height: 740px;

    :global(.contenu-modale) {
      margin-top: 0;
    }
  }

  h4 {
    font-weight: bold;
    font-size: 1.5rem;
    line-height: 2rem;
    color: #161616;
    margin: 16px 0;
  }

  .contenu-modale {
    display: flex;
    flex-direction: column;
    gap: 24px;

    p {
      font-size: 1rem;
      line-height: 1.5rem;
      color: #3a3a3a;
      margin: 0;
    }

    ul {
      padding: 0 0 0 15px;
      margin: 0;
      font-size: 1rem;
      line-height: 1.5rem;
    }

    h5 {
      line-height: 1.75rem;
      font-size: 1.125rem;
      margin: 0 0 4px;
    }
  }
</style>
